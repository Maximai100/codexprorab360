# –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏

## –ü—Ä–æ–±–ª–µ–º–∞ 1: –ö–ª–∏–µ–Ω—Ç –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ, –µ—Å–ª–∏ –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ –±–æ—Ç–∞

### –ü—Ä–∏—á–∏–Ω–∞
Telegram Bot API **–Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç** –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –Ω–∞–ø–∏—Å–∞–ª–∏ –±–æ—Ç—É –ø–µ—Ä–≤—ã–º–∏ (–Ω–µ –Ω–∞–∂–∞–ª–∏ /start). –≠—Ç–æ –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞.

### ‚ùå –ù–µ–ª—å–∑—è —Ä–µ—à–∏—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é
–≠—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ Telegram API, –æ–±–æ–π—Ç–∏ –µ–≥–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ.

### ‚úÖ –ß—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å

#### 1. –£–ª—É—á—à–∏—Ç—å UX –Ω–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —Å—Ç–æ—Ä–æ–Ω–µ

**–í `index.tsx` –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `handleBook`:**

```typescript
try {
    await sendBookingNotifications(notificationPayload);
    
    // –£—Å–ø–µ—Ö - —Å–æ–∑–¥–∞–µ–º –∑–∞–ø–∏—Å—å
    onBookAppointment({ 
        clientName, 
        clientPhone, 
        service: bookingService.name, 
        date, 
        time, 
        duration: bookingService.duration, 
        telegramId: tg.initDataUnsafe?.user?.id 
    });
    
    tg.HapticFeedback.notificationOccurred('success');
    showToast(`‚úÖ –°–ø–∞—Å–∏–±–æ, ${clientName}! –í—ã –∑–∞–ø–∏—Å–∞–Ω—ã.`);
    setBookingService(null);
    
} catch (err: any) {
    const errorMsg = err?.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞';
    
    // –ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω - –≤—Å–µ —Ä–∞–≤–Ω–æ —Å–æ–∑–¥–∞–µ–º –∑–∞–ø–∏—Å—å, –Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É
    if (errorMsg.includes('–Ω–µ –Ω–∞–ø–∏—Å–∞–ª –±–æ—Ç—É') || errorMsg.includes('chat not found')) {
        
        // –°–æ–∑–¥–∞–µ–º –∑–∞–ø–∏—Å—å –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ
        onBookAppointment({ 
            clientName, 
            clientPhone, 
            service: bookingService.name, 
            date, 
            time, 
            duration: bookingService.duration, 
            telegramId: tg.initDataUnsafe?.user?.id 
        });
        
        showToast(`‚úÖ –í—ã –∑–∞–ø–∏—Å–∞–Ω—ã! –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –æ—Ç–∫—Ä–æ–π—Ç–µ @zapismenya_bot –∏ –Ω–∞–∂–º–∏—Ç–µ /start`);
        setBookingService(null);
        
    } else if (errorMsg.includes('–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –±–æ—Ç–∞') || errorMsg.includes('blocked')) {
        showToast('‚ö†Ô∏è –ë–æ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω. –†–∞–∑–±–ª–æ–∫–∏—Ä—É–π—Ç–µ –±–æ—Ç–∞ –≤ Telegram.');
    } else {
        showToast(`‚ùå ${errorMsg}`);
    }
}
```

#### 2. –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"

–í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ `ClientBookingPage` –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–ø–∏—Å–∏:

```typescript
<div className="notification-prompt">
    <p>üí¨ –•–æ—Ç–∏—Ç–µ –ø–æ–ª—É—á–∞—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –∑–∞–ø–∏—Å–∏?</p>
    <a 
        href="https://t.me/zapismenya_bot?start=subscribe" 
        target="_blank"
        className="btn btn-primary"
    >
        –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    </a>
</div>
```

#### 3. –£–ª—É—á—à–∏—Ç—å –±—ç–∫–µ–Ω–¥ - –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –æ—à–∏–±–∫—É, –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω

–ù–∞ –±—ç–∫–µ–Ω–¥–µ `api.prorab360.online/notify`:

```javascript
// –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–ª–∏–µ–Ω—Ç—É
try {
    await bot.sendMessage(telegramId, clientMessage);
    results.client = 'sent';
} catch (error) {
    if (error.response?.body?.error_code === 403) {
        // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ
        results.client = 'not_subscribed';
    } else {
        results.client = 'error';
        console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–ª–∏–µ–Ω—Ç—É:', error);
    }
}

// –û—Ç–ø—Ä–∞–≤–∫–∞ –º–∞—Å—Ç–µ—Ä—É (–í–°–ï–ì–î–ê –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å)
try {
    await bot.sendMessage(masterId, masterMessage);
    results.master = 'sent';
} catch (error) {
    results.master = 'error';
    console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –º–∞—Å—Ç–µ—Ä—É:', error);
}

// –í–æ–∑–≤—Ä–∞—â–∞–µ–º —É—Å–ø–µ—Ö, –¥–∞–∂–µ –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω
return res.json({
    status: 'success',
    message: '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã',
    details: results
});
```

---

## –ü—Ä–æ–±–ª–µ–º–∞ 2: –ú–∞—Å—Ç–µ—Ä—É –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### ‚úÖ –ú–æ–∂–Ω–æ –∏ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å!

### –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:

#### 1. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π masterId
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `masterId` (—ç—Ç–æ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å Telegram ID –º–∞—Å—Ç–µ—Ä–∞, –∞ –Ω–µ ID –∏–∑ –±–∞–∑—ã Directus).

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:**
```javascript
console.log('masterId:', masterId);
console.log('telegramId:', telegramId);
```

#### 2. –ë—ç–∫–µ–Ω–¥ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä—É
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–¥ –Ω–∞ `api.prorab360.online/notify`:

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```javascript
app.post('/notify', async (req, res) => {
    const { masterId, telegramId, clientName, service, date, time } = req.body;
    
    // –°–æ–æ–±—â–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä—É
    const masterMessage = `
üîî –ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å!

üë§ –ö–ª–∏–µ–Ω—Ç: ${clientName}
üíº –£—Å–ª—É–≥–∞: ${service}
üìÖ –î–∞—Ç–∞: ${date}
üïê –í—Ä–µ–º—è: ${time}
    `.trim();
    
    // –°–æ–æ–±—â–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É
    const clientMessage = `
‚úÖ –í—ã –∑–∞–ø–∏—Å–∞–Ω—ã!

üíº –£—Å–ª—É–≥–∞: ${service}
üìÖ –î–∞—Ç–∞: ${date}
üïê –í—Ä–µ–º—è: ${time}

–ñ–¥–µ–º –≤–∞—Å!
    `.trim();
    
    const results = {};
    
    // –í–ê–ñ–ù–û: –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –º–∞—Å—Ç–µ—Ä—É
    try {
        await bot.sendMessage(masterId, masterMessage);
        results.master = 'sent';
        console.log('‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä—É –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ:', masterId);
    } catch (error) {
        results.master = 'error';
        console.error('‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –º–∞—Å—Ç–µ—Ä—É:', error);
    }
    
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–ª–∏–µ–Ω—Ç—É
    try {
        await bot.sendMessage(telegramId, clientMessage);
        results.client = 'sent';
        console.log('‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ:', telegramId);
    } catch (error) {
        if (error.response?.body?.error_code === 403) {
            results.client = 'not_subscribed';
            console.log('‚ö†Ô∏è –ö–ª–∏–µ–Ω—Ç –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ –±–æ—Ç–∞:', telegramId);
        } else {
            results.client = 'error';
            console.error('‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–ª–∏–µ–Ω—Ç—É:', error);
        }
    }
    
    res.json({
        status: 'success',
        message: '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã',
        details: results
    });
});
```

#### 3. –ú–∞—Å—Ç–µ—Ä –Ω–µ –Ω–∞–ø–∏—Å–∞–ª –±–æ—Ç—É /start
–î–∞–∂–µ –º–∞—Å—Ç–µ—Ä –¥–æ–ª–∂–µ–Ω –Ω–∞–ø–∏—Å–∞—Ç—å –±–æ—Ç—É `/start`, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è!

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç @zapismenya_bot
2. –ù–∞–∂–º–∏—Ç–µ `/start`
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å —Å–Ω–æ–≤–∞

#### 4. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π Telegram ID –º–∞—Å—Ç–µ—Ä–∞
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ –±–∞–∑–µ Directus —É –º–∞—Å—Ç–µ—Ä–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `telegramId`.

**–ö–∞–∫ —É–∑–Ω–∞—Ç—å —Å–≤–æ–π Telegram ID:**
```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –≤ —Ä–µ–∂–∏–º–µ –º–∞—Å—Ç–µ—Ä–∞
console.log('–ú–æ–π Telegram ID:', window.Telegram.WebApp.initDataUnsafe?.user?.id);
```

–°—Ä–∞–≤–Ω–∏—Ç–µ —Å —Ç–µ–º, —á—Ç–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ Directus.

---

## –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### –ù–∞ –∫–ª–∏–µ–Ω—Ç–µ (–±—Ä–∞—É–∑–µ—Ä):
- [ ] –û—Ç–∫—Ä—ã—Ç—å DevTools (F12) ‚Üí Console
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:
  ```
  üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–∞: https://api.prorab360.online/notify
  üì¶ –î–∞–Ω–Ω—ã–µ: { masterId: ..., telegramId: ..., ... }
  üì• –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞: 200 OK
  ```
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `masterId` –∏ `telegramId` - —ç—Ç–æ —á–∏—Å–ª–∞, –∞ –Ω–µ `undefined`

### –ù–∞ –±—ç–∫–µ–Ω–¥–µ (api.prorab360.online):
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∑–∞–ø—Ä–æ—Å –ø—Ä–∏—Ö–æ–¥–∏—Ç —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ–±–æ–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥—ã –æ—à–∏–±–æ–∫ –æ—Ç Telegram API

### –í Telegram:
- [ ] –ú–∞—Å—Ç–µ—Ä –Ω–∞–ø–∏—Å–∞–ª –±–æ—Ç—É `/start`
- [ ] –ö–ª–∏–µ–Ω—Ç –Ω–∞–ø–∏—Å–∞–ª –±–æ—Ç—É `/start` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] –ë–æ—Ç –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –Ω–∏ –º–∞—Å—Ç–µ—Ä–æ–º, –Ω–∏ –∫–ª–∏–µ–Ω—Ç–æ–º

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —á–µ—Ä–µ–∑ curl

```bash
curl -X POST https://api.prorab360.online/notify \
  -H "Content-Type: application/json" \
  -d '{
    "masterId": 122991166,
    "telegramId": 122991166,
    "clientName": "–¢–µ—Å—Ç",
    "service": "–°—Ç—Ä–∏–∂–∫–∞",
    "date": "2025-10-20",
    "time": "14:00"
  }'
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ú–∞—Å—Ç–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
- –ö–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (–µ—Å–ª–∏ –ø–æ–¥–ø–∏—Å–∞–Ω)

### –¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º —Ä–µ–∂–∏–º–µ
2. –°–æ–∑–¥–∞–π—Ç–µ –∑–∞–ø–∏—Å—å
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Telegram (—É –º–∞—Å—Ç–µ—Ä–∞ –∏ –∫–ª–∏–µ–Ω—Ç–∞)

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü–æ–∫–∞–∂–∏—Ç–µ –∫–æ–¥ –±—ç–∫–µ–Ω–¥–∞** `api.prorab360.online/notify` - —è –ø–æ–º–æ–≥—É –µ–≥–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏** - —á—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π?
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Telegram ID** - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ª–∏ ID –º–∞—Å—Ç–µ—Ä–∞ –≤ –±–∞–∑–µ?

–ì–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∫–æ–¥ –±—ç–∫–µ–Ω–¥–∞ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π?
