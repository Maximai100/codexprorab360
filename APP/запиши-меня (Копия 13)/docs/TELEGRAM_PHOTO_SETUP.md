# üì∏ –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ –∏–∑ Telegram

## –ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç?

–¢–µ–ø–µ—Ä—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è –ø—Ä–æ—Ñ–∏–ª—è –º–∞—Å—Ç–µ—Ä–∞ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ Telegram** –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –ù–∏–∫–∞–∫–∏—Ö —Ä—É—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è!

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

```
–ú–∞—Å—Ç–µ—Ä –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
         ‚Üì
–ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å—Ç—å –ª–∏ —Ñ–æ—Ç–æ –≤ Directus?
         ‚Üì
–ù–µ—Ç ‚Üí –ó–∞–ø—Ä–æ—Å –∫ Telegram API
         ‚Üì
–ü–æ–ª—É—á–µ–Ω–∏–µ URL —Ñ–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è
         ‚Üì
–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Directus
         ‚Üì
–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∑–∞–ø–∏—Å–∏
```

## –ß—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ (–§—Ä–æ–Ω—Ç–µ–Ω–¥) ‚úÖ

- ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç Avatar –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–æ—Ç–æ
- ‚úÖ API –∫–ª–∏–µ–Ω—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ñ–æ—Ç–æ (`src/api/photo.ts`)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Directus
- ‚úÖ Fallback –Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª—ã, –µ—Å–ª–∏ —Ñ–æ—Ç–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ

## –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å (–ë—ç–∫–µ–Ω–¥) üîß

### –®–∞–≥ 1: –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ –≤ Directus

1. –û—Ç–∫—Ä–æ–π—Ç–µ Directus Admin Panel
2. Settings ‚Üí Data Model ‚Üí masters
3. Create Field:
   - Name: `photoUrl`
   - Type: String
   - Required: No
4. Save

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –±—ç–∫–µ–Ω–¥ —ç–Ω–¥–ø–æ–∏–Ω—Ç

–î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –Ω–∞ –≤–∞—à –±—ç–∫–µ–Ω–¥ (`api.prorab360.online`):

```
GET /get-photo?telegramId={telegramId}
```

**–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:** –°–º. —Ñ–∞–π–ª `BACKEND_PHOTO_API.md`

**–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (Node.js):**

```javascript
const express = require('express');
const axios = require('axios');
const router = express.Router();

const BOT_TOKEN = process.env.TELEGRAM_BOT_TOKEN;

router.get('/get-photo', async (req, res) => {
  try {
    const { telegramId } = req.query;
    
    if (!telegramId) {
      return res.status(400).json({ success: false, message: 'Missing telegramId' });
    }

    // 1. –ü–æ–ª—É—á–∞–µ–º —Ñ–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è
    const photosRes = await axios.get(
      `https://api.telegram.org/bot${BOT_TOKEN}/getUserProfilePhotos`,
      { params: { user_id: telegramId, limit: 1 } }
    );

    const photos = photosRes.data?.result?.photos;
    if (!photos || photos.length === 0) {
      return res.json({ success: true, photoUrl: null });
    }

    // 2. –ü–æ–ª—É—á–∞–µ–º file_path
    const fileId = photos[0][photos[0].length - 1].file_id;
    const fileRes = await axios.get(
      `https://api.telegram.org/bot${BOT_TOKEN}/getFile`,
      { params: { file_id: fileId } }
    );

    const filePath = fileRes.data?.result?.file_path;
    const photoUrl = `https://api.telegram.org/file/bot${BOT_TOKEN}/${filePath}`;

    return res.json({ success: true, photoUrl });
  } catch (error) {
    console.error('Photo fetch error:', error.message);
    return res.status(500).json({ success: false, message: error.message });
  }
});

module.exports = router;
```

### –®–∞–≥ 3: –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# .env –Ω–∞ –±—ç–∫–µ–Ω–¥–µ
TELEGRAM_BOT_TOKEN=your_bot_token_from_botfather
```

### –®–∞–≥ 4: –ü–æ–¥–∫–ª—é—á–∏—Ç—å —Ä–æ—É—Ç

```javascript
// server.js
const photoRouter = require('./routes/photo');
app.use('/get-photo', photoRouter);
```

### –®–∞–≥ 5: –î–µ–ø–ª–æ–π

```bash
git add .
git commit -m "Add photo API endpoint"
git push
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç

```bash
curl "https://api.prorab360.online/get-photo?telegramId=122991166"
```

–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:
```json
{
  "success": true,
  "photoUrl": "https://api.telegram.org/file/bot.../photo.jpg"
}
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫–∞–∫ –º–∞—Å—Ç–µ—Ä
2. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
3. –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
   ```
   üì∏ –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è –∏–∑ Telegram...
   ‚úÖ –§–æ—Ç–æ –ø–æ–ª—É—á–µ–Ω–æ: https://...
   ‚úÖ –§–æ—Ç–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ Directus –¥–ª—è –º–∞—Å—Ç–µ—Ä–∞: 123
   ```
4. –§–æ—Ç–æ –¥–æ–ª–∂–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤ —à–∞–ø–∫–µ –ø—Ä–æ—Ñ–∏–ª—è

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ Directus Admin
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é `masters`
3. –ù–∞–π–¥–∏—Ç–µ –∑–∞–ø–∏—Å—å –º–∞—Å—Ç–µ—Ä–∞
4. –ü–æ–ª–µ `photoUrl` –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω–æ

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚ö†Ô∏è

URL —Ñ–æ—Ç–æ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–∫–µ–Ω –±–æ—Ç–∞! –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ (–ü—Ä–æ—Å—Ç–æ–π)
–û—Ç–¥–∞–≤–∞–π—Ç–µ —Ñ–æ—Ç–æ –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ –≤–∞—à —Å–µ—Ä–≤–µ—Ä –±–µ–∑ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è —Ç–æ–∫–µ–Ω–∞.

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ó–∞–≥—Ä—É–∑–∫–∞ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (–õ—É—á—à–∏–π)
–ó–∞–≥—Ä—É–∂–∞–π—Ç–µ —Ñ–æ—Ç–æ –≤ S3/Cloudinary/Directus Files –∏ –≤–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π URL.

**–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏:** –°–º. —Ä–∞–∑–¥–µ–ª "–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å" –≤ `BACKEND_PHOTO_API.md`

## –ß—Ç–æ –µ—Å–ª–∏ –±—ç–∫–µ–Ω–¥ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω?

–ù–∏—á–µ–≥–æ —Å—Ç—Ä–∞—à–Ω–æ–≥–æ! –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å:
- –ë—É–¥—É—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å—Å—è –∫—Ä–∞—Å–∏–≤—ã–µ –∏–Ω–∏—Ü–∏–∞–ª—ã –≤–º–µ—Å—Ç–æ —Ñ–æ—Ç–æ
- –ù–∏–∫–∞–∫–∏—Ö –æ—à–∏–±–æ–∫ –Ω–µ –±—É–¥–µ—Ç
- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ Directus

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–∏

‚úÖ –ú–∞—Å—Ç–µ—Ä –Ω–µ –¥–µ–ª–∞–µ—Ç –Ω–∏—á–µ–≥–æ - —Ñ–æ—Ç–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å–∞–º–æ  
‚úÖ –í—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ —Ñ–æ—Ç–æ (–ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ)  
‚úÖ –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–π –¥–∏–∑–∞–π–Ω –¥–ª—è –≤—Å–µ—Ö –º–∞—Å—Ç–µ—Ä–æ–≤  
‚úÖ –ü–æ–≤—ã—à–∞–µ—Ç –¥–æ–≤–µ—Ä–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤  
‚úÖ Fallback –Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª—ã, –µ—Å–ª–∏ —Ñ–æ—Ç–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ  

## –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

**Q: –ß—Ç–æ –µ—Å–ª–∏ —É –º–∞—Å—Ç–µ—Ä–∞ –Ω–µ—Ç —Ñ–æ—Ç–æ –≤ Telegram?**  
A: –ë—É–¥—É—Ç –ø–æ–∫–∞–∑–∞–Ω—ã —Ü–≤–µ—Ç–Ω—ã–µ –∏–Ω–∏—Ü–∏–∞–ª—ã (–∫–∞–∫ —Å–µ–π—á–∞—Å).

**Q: –û–±–Ω–æ–≤–∏—Ç—Å—è –ª–∏ —Ñ–æ—Ç–æ, –µ—Å–ª–∏ –º–∞—Å—Ç–µ—Ä –∏–∑–º–µ–Ω–∏—Ç –µ–≥–æ –≤ Telegram?**  
A: –ù–µ—Ç, —Ñ–æ—Ç–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑. –î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å `photoUrl` –∏–∑ Directus.

**Q: –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–≤–æ–µ —Ñ–æ—Ç–æ –≤–º–µ—Å—Ç–æ Telegram?**  
A: –î–∞, –ø—Ä–æ—Å—Ç–æ –≤—Ä—É—á–Ω—É—é —É–∫–∞–∂–∏—Ç–µ URL –≤ –ø–æ–ª–µ `photoUrl` –≤ Directus.

**Q: –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ —ç—Ç–æ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤?**  
A: –ù–µ—Ç, —Ñ–æ—Ç–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –º–∞—Å—Ç–µ—Ä–æ–≤. –ö–ª–∏–µ–Ω—Ç—ã –≤–∏–¥—è—Ç —Ñ–æ—Ç–æ –º–∞—Å—Ç–µ—Ä–∞.

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–ª–µ `photoUrl` –≤ Directus
2. [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç `/get-photo` –Ω–∞ –±—ç–∫–µ–Ω–¥–µ
3. [ ] –î–æ–±–∞–≤–∏—Ç—å `TELEGRAM_BOT_TOKEN` –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
4. [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ
5. [ ] –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å –Ω–∞ production
6. [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –≤ Telegram WebApp

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –æ—à–∏–±–∫–∏
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±—ç–∫–µ–Ω–¥–∞
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ BOT_TOKEN –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π
4. –°–º. –ø–æ–¥—Ä–æ–±–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤ `BACKEND_PHOTO_API.md`

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –§—Ä–æ–Ω—Ç–µ–Ω–¥ –≥–æ—Ç–æ–≤ | üîß –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –±—ç–∫–µ–Ω–¥–∞

**–î–∞—Ç–∞:** 19.10.2025
