# Журнал изменений проекта "Смета за 5 минут"

## Обзор проекта

Это веб-приложение для создания и управления сметами, предназначенное для использования в качестве Telegram Web App. Оно позволяет пользователям управлять проектами, создавать подробные сметы, отслеживать финансы и многое другое.

### Ключевые возможности:

- **Управление проектами**: Создание проектов с информацией о клиенте и адресе.
- **Создание смет**: Составление смет с позициями (работы/материалы), количеством, ценами, скидками и налогами.
- **Финансовый учет**: Регистрация расходов и оплат по каждому проекту.
- **Отчетность**: Экспорт смет в PDF, создание списков покупок и актов выполненных работ.
- **Локальное хранение данных**: Все данные сохраняются в `localStorage` браузера.
- **AI-ассистент**: Использует Gemini API для предложения позиций сметы на основе описания на естественном языке.
- **Резервное копирование и восстановление**: Возможность сохранять и загружать все данные приложения из файла.
- **Учет инвентаря**: Учет инструментов и оборудования с указанием местоположения.

## Список изменений

### 29.08.2025 (вечер)

- **Глобальный рефакторинг интерфейса (UI/UX)**:
    - Шапка приложения сделана глобальной и закрепленной. В нее перенесены основные действия: смена темы, доступ к справочнику, списку смет и настройкам.
    - Нижняя панель навигации была очищена от дублирующихся иконок ("Справочник", "Профиль").
    - Добавлен логотип и новое название приложения "Прораб" в шапку.
- **Редизайн главного экрана "Рабочий стол"**:
    - Удалены кнопки быстрых действий.
    - Добавлена новая функция "Мои документы" для хранения файлов, не привязанных к проектам.
    - Обновлен дизайн карточек "Мои задачи" и "Блокнот".
- **Сокрытие функции AI-помощника**:
    - Кнопки вызова AI-помощника временно убраны из интерфейса до будущих обновлений.
- **Исправление множественных ошибок в UI**:
    - Устранены проблемы с наложением кнопок в модальном окне "Мои документы".
    - Исправлена ошибка, при которой клавиатура перекрывала поле "Описание" в окне добавления транзакции.
    - Локализованы кнопки "Edit" и "Del" на русский язык в модальном окне "Справочник".
    - Скорректирован отступ нижней навигационной панели для корректного отображения на iPhone (учет safe-area).
- **Исправление ошибки генерации PDF**:
    - Обновлена версия библиотеки `jspdf-autotable`, что решило проблему со шрифтами и позволило снова генерировать PDF-документы.

### 29.08.2025

- **Добавлен "Рабочий стол"**: 
    - Реализован новый стартовый экран, который служит центральным хабом для пользователя.
    - Добавлены виджеты: "Мои задачи" (to-do лист), "Блокнот" для быстрых заметок, "Последние документы" и "Быстрый доступ" к основным функциям.
    - Вся информация с рабочего стола сохраняется локально.
    - В навигацию добавлена кнопка "Главная" для возврата на этот экран.
- **Исправлена работа AI-помощника**:
    - Настроено корректное использование API-ключа через файл `.env.local`.
    - Обновлена модель на `gemini-2.0-flash` для повышения качества ответов.
- **Управление репозиторием**:
    - Создан файл `GEMINI.md` с подробным описанием проекта для облегчения будущих доработок.
    - Все новые функции и исправления были успешно отправлены в удаленный репозиторий GitHub.

### 28.08.2025

- **Первоначальная настройка**: Установлены зависимости npm и запущен сервер разработки.
- **Исправление ошибок**:
    - Устранена критическая ошибка с отсутствующим импортом `GoogleGenerativeAI`.
    - Удален жестко закодированный API-ключ и настроено использование переменных окружения.
    - Исправлен некорректный вызов Gemini API.
- **Рефакторинг кода**:
    - Большой файл `index.tsx` был разделен на множество мелких компонентов, что значительно улучшило структуру проекта и его поддерживаемость.
    - Созданы отдельные файлы для типов (`types.ts`), утилит (`utils.ts`) и констант (`constants.ts`).
- **Улучшения интерфейса (UI/UX)**:
    - Добавлены индикаторы загрузки для процессов сохранения и экспорта в PDF.
    - Улучшена визуальная обратная связь при перетаскивании элементов сметы.
- **Новые функции**:
    - Реализована функция резервного копирования и восстановления данных через настройки профиля.
    - **Добавлен раздел "Инвентарь"**:
        - Реализована возможность учета инструментов и оборудования.
        - Добавлено добавление, удаление и обновление инструментов.
        - Для каждого инструмента можно указать местоположение: "На базе" или на одном из активных проектов.
        - Добавлен раздел для ведения заметок по инвентарю.